library(tidyverse)
library(tidytext)
library(DT)
library(scales)
library(wordcloud2)
library(gridExtra)
library(ngram)
library(igraph)
library(ggraph)
hm_data <- read_csv("/Users/zhongming/Documents/GitHub/Spring2019-Proj1-silverbulletKID/output/processed_moments.csv")
urlfile<-'https://raw.githubusercontent.com/rit-public/HappyDB/master/happydb/data/demographic.csv'
urlfile2<-'https://raw.githubusercontent.com/rit-public/HappyDB/master/happydb/data/senselabel.csv'
demo_data <- read_csv(urlfile)
sense_data<-read_csv(urlfile2)
hm_data <- hm_data %>%
inner_join(sense_data, by="hmid")
hm_data<-hm_data %>%
inner_join(demo_data, by = "wid") %>%
select(wid,
predicted_category,
num_sentence,
gender,
marital,
parenthood,
reflection_period,
age,
country,
ground_truth_category,
POS,
supersenseLabel,
text) %>%
mutate(count = sapply(hm_data$text, wordcount)) %>%
filter(gender %in% c("m", "f")) %>%
filter(marital %in% c("single", "married")) %>%
filter(parenthood %in% c("n", "y")) %>%
filter(reflection_period %in% c("24h", "3m")) %>%
mutate(reflection_period = fct_recode(reflection_period,
months_3 = "3m", hours_24 = "24h"))
bag_of_words <-  hm_data %>%
unnest_tokens(word, text)
library(dplyr)
hm_bigrams <- hm_data %>%
filter(count!=1) %>%
unnest_tokens(bigram, text, token = "ngrams", n = 2)
bigram_counts <- hm_bigrams %>%
separate(bigram, c("word1", "word2"), sep = " ") %>%
count(word1, word2, sort = TRUE)
library(tidyr)
library(tidytext)
sentiment <-bag_of_words %>%
inner_join(get_sentiments("afinn")) %>%
group_by(index = country) %>%
summarise(sentiment = mean(score)) %>%
mutate(method = "AFINN")
ggplot(data=sentiment,aes(fct_reorder(index,sentiment, .fun = mean,.desc = T),sentiment))+geom_bar(stat = "identity")+xlab("country")+theme(text = element_text(size=5),axis.text.x = element_text(angle = 90))
bag_of_words %>% filter(country=="NOR"|country=="HRV"|country=="ASM") %>%
count(word, sort = TRUE) %>% wordcloud2(size = 0.6,rotateRatio = 0)
sentiment <-bag_of_words %>%
inner_join(get_sentiments("afinn")) %>%
group_by(index = age) %>%
summarise(sentiment = mean(score)) %>%
mutate(method = "AFINN")
ggplot(data=sentiment,aes(index,sentiment))+geom_bar(stat = "identity")+theme(text = element_text(size=7),axis.text.x = element_text(angle = 90))
library(topicmodels)
d=filter(hm_bigrams,predicted_category=="leisure")[c(2,15,14)]
names(hm_bigrams)
library(topicmodels)
d=filter(hm_bigrams,predicted_category=="leisure")[c(1,14,13)]
d=d %>%cast_dtm(wid, bigram, count)
ap_lda <- LDA(d, k = 2, control = list(seed = 1234))
library(tidytext)
ap_topics <- tidy(ap_lda, matrix = "beta")
